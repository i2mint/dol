<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dol.util &mdash; dol 0.2.61 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=ccd6299a"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dol.zipfiledol" href="zipfiledol.html" />
    <link rel="prev" title="dol.trans" href="trans.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            dol
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dol.html">dol</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendable.html">dol.appendable</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">dol.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">dol.caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="dig.html">dol.dig</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">dol.errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="explicit.html">dol.explicit</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesys.html">dol.filesys</a></li>
<li class="toctree-l1"><a class="reference internal" href="kv_codecs.html">dol.kv_codecs</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">dol.misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixins.html">dol.mixins</a></li>
<li class="toctree-l1"><a class="reference internal" href="naming.html">dol.naming</a></li>
<li class="toctree-l1"><a class="reference internal" href="paths.html">dol.paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">dol.recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap.html">dol.scrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap/new_store_wrap.html">dol.scrap.new_store_wrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap/store_factories.html">dol.scrap.store_factories</a></li>
<li class="toctree-l1"><a class="reference internal" href="signatures.html">dol.signatures</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources.html">dol.sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/base_test.html">dol.tests.base_test</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/pickability_test.html">dol.tests.pickability_test</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/scrap.html">dol.tests.scrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_appendable.html">dol.tests.test_appendable</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_dol_tools.html">dol.tests.test_dol_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_edge_cases.html">dol.tests.test_edge_cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_fanout_stores.html">dol.tests.test_fanout_stores</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_filesys.html">dol.tests.test_filesys</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_kv_codecs.html">dol.tests.test_kv_codecs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_paths.html">dol.tests.test_paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/utils_for_tests.html">dol.tests.utils_for_tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">dol.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="trans.html">dol.trans</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">dol.util</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.LiteralVal"><code class="docutils literal notranslate"><span class="pre">LiteralVal</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dol.util.LiteralVal.get_val"><code class="docutils literal notranslate"><span class="pre">LiteralVal.get_val()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.Pipe"><code class="docutils literal notranslate"><span class="pre">Pipe</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.add_as_attribute_of"><code class="docutils literal notranslate"><span class="pre">add_as_attribute_of()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.add_attrs"><code class="docutils literal notranslate"><span class="pre">add_attrs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.chain_get"><code class="docutils literal notranslate"><span class="pre">chain_get()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.copy_attrs"><code class="docutils literal notranslate"><span class="pre">copy_attrs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.decorate_callables"><code class="docutils literal notranslate"><span class="pre">decorate_callables()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.fill_with_dflts"><code class="docutils literal notranslate"><span class="pre">fill_with_dflts()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.flatten_pipe"><code class="docutils literal notranslate"><span class="pre">flatten_pipe()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.format_invocation"><code class="docutils literal notranslate"><span class="pre">format_invocation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.groupby"><code class="docutils literal notranslate"><span class="pre">groupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.has_enabled_clear_method"><code class="docutils literal notranslate"><span class="pre">has_enabled_clear_method()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.igroupby"><code class="docutils literal notranslate"><span class="pre">igroupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.imdict"><code class="docutils literal notranslate"><span class="pre">imdict</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.inject_method"><code class="docutils literal notranslate"><span class="pre">inject_method()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.instance_checker"><code class="docutils literal notranslate"><span class="pre">instance_checker()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.lazyprop"><code class="docutils literal notranslate"><span class="pre">lazyprop</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.lazyprop_w_sentinel"><code class="docutils literal notranslate"><span class="pre">lazyprop_w_sentinel</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.max_common_prefix"><code class="docutils literal notranslate"><span class="pre">max_common_prefix()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.named_partial"><code class="docutils literal notranslate"><span class="pre">named_partial()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.norm_kv_filt"><code class="docutils literal notranslate"><span class="pre">norm_kv_filt()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.not_a_mac_junk_path"><code class="docutils literal notranslate"><span class="pre">not_a_mac_junk_path()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.num_of_args"><code class="docutils literal notranslate"><span class="pre">num_of_args()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.num_of_required_args"><code class="docutils literal notranslate"><span class="pre">num_of_required_args()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.partialclass"><code class="docutils literal notranslate"><span class="pre">partialclass()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.regroupby"><code class="docutils literal notranslate"><span class="pre">regroupby()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.staticproperty"><code class="docutils literal notranslate"><span class="pre">staticproperty</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.str_to_var_str"><code class="docutils literal notranslate"><span class="pre">str_to_var_str()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.truncate_string_with_marker"><code class="docutils literal notranslate"><span class="pre">truncate_string_with_marker()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.written_bytes"><code class="docutils literal notranslate"><span class="pre">written_bytes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.util.written_key"><code class="docutils literal notranslate"><span class="pre">written_key()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zipfiledol.html">dol.zipfiledol</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dol</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">dol.util</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/module_docs/dol/util.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dol.util">
<span id="dol-util"></span><h1>dol.util<a class="headerlink" href="#module-dol.util" title="Link to this heading"></a></h1>
<p>General util objects</p>
<dl class="py class">
<dt class="sig sig-object py" id="dol.util.LiteralVal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">LiteralVal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#LiteralVal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.LiteralVal" title="Link to this definition"></a></dt>
<dd><p>An object to indicate that the value should be considered literally.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">LiteralVal</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">get_val</span><span class="p">()</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">()</span>
<span class="go">42</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dol.util.LiteralVal.get_val">
<span class="sig-name descname"><span class="pre">get_val</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#LiteralVal.get_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.LiteralVal.get_val" title="Link to this definition"></a></dt>
<dd><p>Get the value wrapped by LiteralVal instance.</p>
<p>One might want to use <code class="docutils literal notranslate"><span class="pre">literal.get_val()</span></code> instead <code class="docutils literal notranslate"><span class="pre">literal()</span></code> to get the
value a <code class="docutils literal notranslate"><span class="pre">LiteralVal</span></code> is wrapping because <code class="docutils literal notranslate"><span class="pre">.get_val</span></code> is more explicit.</p>
<p>That said, with a bit of hesitation, we allow the <code class="docutils literal notranslate"><span class="pre">literal()</span></code> form as well
since it is useful in situations where we need to use a callback function to
get a value.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.util.Pipe">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">Pipe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">funcs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">named_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#Pipe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.Pipe" title="Link to this definition"></a></dt>
<dd><p>Simple function composition. That is, gives you a callable that implements input -&gt; f_1 -&gt; … -&gt; f_n -&gt; output.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x: 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>You can name functions, but this would just be for documentation purposes.
The names are completely ignored.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">add_numbers</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">multiply_by_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">stringify</span> <span class="o">=</span> <span class="nb">str</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;10&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Pipe instances don’t have a __name__ etc. So some expectations of normal functions are not met.</p></li>
<li><p>Pipe instance are pickalable (as long as the functions that compose them are)</p></li>
</ul>
<p>You can specify a single functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>but</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Pipe</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You need to specify at least one function!</span>
</pre></div>
</div>
<p>You can specify an instance name and/or doc with the special (reserved) argument
names <code class="docutils literal notranslate"><span class="pre">__name__</span></code> and <code class="docutils literal notranslate"><span class="pre">__doc__</span></code> (which therefore can’t be used as function names):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="n">add_it</span><span class="o">=</span><span class="nb">sum</span><span class="p">,</span> <span class="vm">__name__</span><span class="o">=</span><span class="s1">&#39;map_and_sum&#39;</span><span class="p">,</span> <span class="vm">__doc__</span><span class="o">=</span><span class="s1">&#39;Apply func and add&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;map_and_sum&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="go">&#39;Apply func and add&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.add_as_attribute_of">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">add_as_attribute_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#add_as_attribute_of"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.add_as_attribute_of" title="Link to this definition"></a></dt>
<dd><p>Decorator that adds a function as an attribute of a container object <code class="docutils literal notranslate"><span class="pre">obj</span></code>.</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">name</span></code> is given, the <code class="docutils literal notranslate"><span class="pre">__name__</span></code> of the function will be used, with a
leading underscore removed. This is useful for adding helper functions to main
“container” functions without polluting the namespace of the module, at least
from the point of view of imports and tab completion.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@add_as_attribute_of</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">_helper</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="s1">&#39;helper&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">helper</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In reality, any object that has a <code class="docutils literal notranslate"><span class="pre">__name__</span></code> can be added to the attribute of
<code class="docutils literal notranslate"><span class="pre">obj</span></code>, but the intention is to add helper functions to main “container” functions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.add_attrs">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">add_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remember_added_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_attr_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#add_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.add_attrs" title="Link to this definition"></a></dt>
<dd><p>Make a function that will add attributes to an obj.
Originally meant to be used as a decorator of a function, to inject</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol.util</span> <span class="kn">import</span> <span class="n">add_attrs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@add_attrs</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="s1">&#39;bituate&#39;</span><span class="p">,</span> <span class="n">hello</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)]</span>
<span class="go">[&#39;bar&#39;, &#39;hello&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span>
<span class="go">&#39;bituate&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">hello</span>
<span class="go">&#39;world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">_added_attrs</span>  <span class="c1"># Another attr was added to hold the list of attributes added (in case we need to remove them</span>
<span class="go">[&#39;bar&#39;, &#39;hello&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.chain_get">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">chain_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#chain_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.chain_get" title="Link to this definition"></a></dt>
<dd><p>Returns the <code class="docutils literal notranslate"><span class="pre">d[key]</span></code> value for the first <code class="docutils literal notranslate"><span class="pre">key</span></code> in <code class="docutils literal notranslate"><span class="pre">keys</span></code> that is in <code class="docutils literal notranslate"><span class="pre">d</span></code>, and default if none are found</p>
<p>Note: Think of <code class="docutils literal notranslate"><span class="pre">collections.ChainMap</span></code> where you can look for a single key in a sequence of maps until we find it.
Here we look for a sequence of keys in a single map, stopping as soon as we find a key that the map has.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;here&#39;</span><span class="p">:</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;there&#39;</span><span class="p">:</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;every&#39;</span><span class="p">:</span> <span class="s1">&#39;where&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_get</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;not there&#39;</span><span class="p">,</span> <span class="s1">&#39;not there either&#39;</span><span class="p">,</span> <span class="s1">&#39;there&#39;</span><span class="p">,</span> <span class="s1">&#39;every&#39;</span><span class="p">])</span>
<span class="go">&#39;and&#39;</span>
</pre></div>
</div>
<p>Notice how <code class="docutils literal notranslate"><span class="pre">'not</span> <span class="pre">there'</span></code> and <code class="docutils literal notranslate"><span class="pre">'not</span> <span class="pre">there</span> <span class="pre">either'</span></code> are skipped, <code class="docutils literal notranslate"><span class="pre">'there'</span></code> is found and used to retrieve
the value, and <code class="docutils literal notranslate"><span class="pre">'every'</span></code> is not even checked (because <code class="docutils literal notranslate"><span class="pre">'there'</span></code> was found).
If non of the keys are found, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned by default.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chain_get</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;these&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<p>You can change this default though:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain_get</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;these&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Not Found&#39;</span><span class="p">)</span>
<span class="go">&#39;Not Found&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.copy_attrs">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">copy_attrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error_if_an_attr_is_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#copy_attrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.copy_attrs" title="Link to this definition"></a></dt>
<dd><p>Copy attributes from one object to another.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">B</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="n">yy</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">... </span>    <span class="n">zzz</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_of</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_of</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">{&#39;x&#39;: 0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy_attrs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="s1">&#39;yy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_of</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">{&#39;x&#39;: 0, &#39;yy&#39;: 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy_attrs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;zzz&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_of</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">{&#39;x&#39;: 1, &#39;yy&#39;: 2, &#39;zzz&#39;: 3}</span>
</pre></div>
</div>
<p>But if you try to copy something that <cite>B</cite> (the source) doesn’t have, copy_attrs will complain:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy_attrs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="s1">&#39;this_is_not_an_attr&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">type object &#39;B&#39; has no attribute &#39;this_is_not_an_attr&#39;</span>
</pre></div>
</div>
<p>If you tell it not to complain, it’ll just ignore attributes that are not in source.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy_attrs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;nothing&#39;</span><span class="p">,</span> <span class="s1">&#39;here&#39;</span><span class="p">,</span> <span class="s1">&#39;exists&#39;</span><span class="p">],</span> <span class="n">raise_error_if_an_attr_is_missing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_of</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">{&#39;x&#39;: 1, &#39;yy&#39;: 2, &#39;zzz&#39;: 3}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.decorate_callables">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">decorate_callables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decorator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#decorate_callables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.decorate_callables" title="Link to this definition"></a></dt>
<dd><p>Decorate all (non-underscored) callables in a class with a decorator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol.util</span> <span class="kn">import</span> <span class="n">LiteralVal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@decorate_callables</span><span class="p">(</span><span class="nb">property</span><span class="p">)</span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">wet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s1">&#39;dry&#39;</span>
<span class="gp">... </span>    <span class="nd">@LiteralVal</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">big</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s1">&#39;small&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">wet</span>
<span class="go">&#39;dry&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">big</span><span class="p">()</span>
<span class="go">&#39;small&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.fill_with_dflts">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">fill_with_dflts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dflt_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#fill_with_dflts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.fill_with_dflts" title="Link to this definition"></a></dt>
<dd><p>Fed up with multiline handling of dict arguments?
Fed up of repeating the if d is None: d = {} lines ad nauseam (because defaults can’t be dicts as a default
because dicts are mutable blah blah, and the python kings don’t seem to think a mutable dict is useful enough)?
Well, my favorite solution would be a built-in handling of the problem of complex/smart defaults,
that is visible in the code and in the docs. But for now, here’s one of the tricks I use.</p>
<p>Main use is to handle defaults of function arguments. Say you have a function <cite>func(d=None)</cite> and you want
<cite>d</cite> to be a dict that has at least the keys <cite>foo</cite> and <cite>bar</cite> with default values 7 and 42 respectively.
Then, in the beginning of your function code you’ll say:</p>
<blockquote>
<div><p>d = fill_with_dflts(d, {‘a’: 7, ‘b’: 42})</p>
</div></blockquote>
<p>See examples to know how to use it.</p>
<p>ATTENTION: A shallow copy of the dict is made. Know how that affects you (or not).
ATTENTION: This is not recursive: It won’t be filling any nested fields with defaults.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – The dict you want to “fill”</p></li>
<li><p><strong>dflt_dict</strong> – What to fill it with (a {k: v, …} dict where if k is missing in d, you’ll get a new field k, with
value v.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>val entries (if the key was missing in d).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dict with the new key</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_with_dflts</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_with_dflts</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
<span class="go">{&#39;a&#39;: 7, &#39;b&#39;: 42}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_with_dflts</span><span class="p">({},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
<span class="go">{&#39;a&#39;: 7, &#39;b&#39;: 42}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_with_dflts</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">})</span>
<span class="go">{&#39;a&#39;: 7, &#39;b&#39;: 1000}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.flatten_pipe">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">flatten_pipe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipe</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#flatten_pipe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.flatten_pipe" title="Link to this definition"></a></dt>
<dd><p>Unravel nested Pipes to get a flat ‘sequence of functions’ version of input.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">flatten_pipe</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">19</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.format_invocation">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">format_invocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#format_invocation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.format_invocation" title="Link to this definition"></a></dt>
<dd><p>Given a name, positional arguments, and keyword arguments, format
a basic Python-style function call.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">format_invocation</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span>
<span class="go">func(1, 2, c=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">format_invocation</span><span class="p">(</span><span class="s1">&#39;a_func&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)))</span>
<span class="go">a_func(1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">format_invocation</span><span class="p">(</span><span class="s1">&#39;kw_func&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]))</span>
<span class="go">kw_func(a=1, b=2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.groupby">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">groupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">items:</span> <span class="pre">~typing.Iterable[~typing.Any],</span> <span class="pre">key:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Hashable],</span> <span class="pre">val:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">group_factory=&lt;class</span> <span class="pre">'list'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../../_modules/dol/util.html#groupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.groupby" title="Link to this definition"></a></dt>
<dd><p>Groups items according to group keys updated from those items through the given
(<a href="#id7"><span class="problematic" id="id8">item_to_</span></a>)key function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> – iterable of items</p></li>
<li><p><strong>key</strong> – The function that computes a key from an item. Needs to return a hashable.</p></li>
<li><p><strong>val</strong> – An optional function that computes a val from an item. If not given, the item itself will be taken.</p></li>
<li><p><strong>group_factory</strong> – The function to make new (empty) group objects and accumulate group items.
group_items = group_factory() will be called to make a new empty group collection
group_items.append(x) will be called to add x to that collection
The default is <cite>list</cite></p></li>
</ul>
</dd>
</dl>
<p>Returns: A dict of {group_key: items_in_that_group, …}</p>
<p>See Also: regroupby, itertools.groupby, and dol.source.SequenceKvReader</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">groupby</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{0: [0, 3, 6, 9], 1: [1, 4, 7, 10], 2: [2, 5, 8]}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">len</span><span class="p">)</span>
<span class="go">{3: [&#39;the&#39;, &#39;fox&#39;, &#39;box&#39;], 2: [&#39;is&#39;, &#39;in&#39;], 1: [&#39;a&#39;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;two&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">key_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;more&#39;</span><span class="p">))</span>
<span class="go">{&#39;more&#39;: [&#39;the&#39;, &#39;fox&#39;, &#39;box&#39;], &#39;two&#39;: [&#39;is&#39;, &#39;in&#39;], &#39;one&#39;: [&#39;a&#39;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">)</span>
<span class="go">{True: [&#39;the&#39;, &#39;in&#39;, &#39;a&#39;], False: [&#39;fox&#39;, &#39;is&#39;, &#39;box&#39;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">,</span> <span class="s1">&#39;stopwords&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">)])</span>
<span class="go">{&#39;stopwords&#39;: [&#39;the&#39;, &#39;in&#39;, &#39;a&#39;], &#39;words&#39;: [&#39;fox&#39;, &#39;is&#39;, &#39;box&#39;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.has_enabled_clear_method">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">has_enabled_clear_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#has_enabled_clear_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.has_enabled_clear_method" title="Link to this definition"></a></dt>
<dd><p>Returns True iff obj has a clear method that is enabled (i.e. not disabled)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.igroupby">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">igroupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">items:</span> <span class="pre">~typing.Iterable[~typing.Any],</span> <span class="pre">key:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Hashable],</span> <span class="pre">val:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">group_factory:</span> <span class="pre">~typing.Callable[[],</span> <span class="pre">~typing.Iterable[~typing.Any]]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'list'&gt;,</span> <span class="pre">group_release_cond:</span> <span class="pre">~typing.Callable[[~typing.Hashable,</span> <span class="pre">~typing.Iterable[~typing.Any]],</span> <span class="pre">bool]</span> <span class="pre">|</span> <span class="pre">~typing.Callable[[dict,</span> <span class="pre">~typing.Hashable,</span> <span class="pre">~typing.Iterable[~typing.Any]],</span> <span class="pre">bool]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;,</span> <span class="pre">release_remainding=True,</span> <span class="pre">append_to_group_items:</span> <span class="pre">~typing.Callable[[~typing.Iterable[~typing.Any],</span> <span class="pre">~typing.Any],</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;method</span> <span class="pre">'append'</span> <span class="pre">of</span> <span class="pre">'list'</span> <span class="pre">objects&gt;,</span> <span class="pre">grouper_mapping=&lt;class</span> <span class="pre">'collections.defaultdict'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#igroupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.igroupby" title="Link to this definition"></a></dt>
<dd><p>The generator version of dol groupby.
Groups items according to group keys updated from those items through the given (<a href="#id9"><span class="problematic" id="id10">item_to_</span></a>)key function,
yielding the groups according to a logic defined by <code class="docutils literal notranslate"><span class="pre">group_release_cond</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> – iterable of items</p></li>
<li><p><strong>key</strong> – The function that computes a key from an item. Needs to return a hashable.</p></li>
<li><p><strong>val</strong> – An optional function that computes a val from an item. If not given, the item itself will be taken.</p></li>
<li><p><strong>group_factory</strong> – The function to make new (empty) group objects and accumulate group items.
group_items = group_collector() will be called to make a new empty group collection
group_items.append(x) will be called to add x to that collection
The default is <cite>list</cite></p></li>
<li><p><strong>group_release_cond</strong> – A boolean function that will be applied, at every iteration,
to the accumulated items of the group that was just updated,
and determines (if True) if the (group_key, group_items) should be yielded.
The default is False, which results in
<code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">group_key,</span> <span class="pre">group_items:</span> <span class="pre">False</span></code> being used.</p></li>
<li><p><strong>release_remainding</strong> – Once the input items have been consumed, there may still be some
items in the grouping “cache”. <code class="docutils literal notranslate"><span class="pre">release_remainding</span></code> is a boolean that indicates whether
the contents of this cache should be released or not.</p></li>
</ul>
</dd>
</dl>
<p>Yields: <code class="docutils literal notranslate"><span class="pre">(group_key,</span> <span class="pre">items_in_that_group)</span></code> pairs</p>
<p>The following will group numbers according to their parity (0 for even, 1 for odd),
releasing a list of numbers collected when that list reaches length 3:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">igroupby</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">group_release_cond</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[(0, [0, 2, 4]), (1, [1, 3, 5]), (0, [6, 8, 10]), (1, [7, 9])]</span>
</pre></div>
</div>
<p>If we specify <code class="docutils literal notranslate"><span class="pre">release_remainding=False</span></code> though, we won’t get</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">igroupby</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">group_release_cond</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">release_remainding</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[(0, [0, 2, 4]), (1, [1, 3, 5]), (0, [6, 8, 10])]</span>
</pre></div>
</div>
<p># &gt;&gt;&gt; grps = partial(igroupby, group_release_cond=False, release_remainding=True)</p>
<p>Below we show that, with the default <code class="docutils literal notranslate"><span class="pre">group_release_cond</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">k,</span> <span class="pre">v:</span> <span class="pre">False</span></code>
and release_remainding=True`` we have <code class="docutils literal notranslate"><span class="pre">dict(igroupby(...))</span> <span class="pre">==</span> <span class="pre">groupby(...)</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol</span> <span class="kn">import</span> <span class="n">groupby</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">igroupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">))</span> <span class="o">==</span> <span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">igroupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">))</span> <span class="o">==</span> <span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">==</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;two&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kws</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">key_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;more&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">igroupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">))</span> <span class="o">==</span> <span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;more&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">],</span> <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">],</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kws</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">igroupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">))</span> <span class="o">==</span> <span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">==</span> <span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kws</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">,</span> <span class="s1">&#39;stopwords&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">igroupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">))</span> <span class="o">==</span> <span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;stopwords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;words&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.util.imdict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">imdict</span></span><a class="reference internal" href="../../_modules/dol/util.html#imdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.imdict" title="Link to this definition"></a></dt>
<dd><p>A frozen hashable dict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.inject_method">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">inject_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#inject_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.inject_method" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>method_function could be:</dt><dd><ul class="simple">
<li><p>a function</p></li>
<li><p>a {method_name: function, …} dict (for multiple injections)</p></li>
<li><p>a list of functions or (function, method_name) pairs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.instance_checker">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">instance_checker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#instance_checker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.instance_checker" title="Link to this definition"></a></dt>
<dd><p>Makes a filter function that checks the type of an object.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">instance_checker</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.util.lazyprop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">lazyprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#lazyprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.lazyprop" title="Link to this definition"></a></dt>
<dd><p>A descriptor implementation of lazyprop (cached property).
Made based on David Beazley’s “Python Cookbook” book and enhanced with boltons.cacheutils ideas.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
<span class="gp">... </span>    <span class="nd">@lazyprop</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;generating &quot;len&quot;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Test</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{&#39;a&#39;: [0, 1, 2, 3, 4]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>
<span class="go">generating &quot;len&quot;</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{&#39;a&#39;: [0, 1, 2, 3, 4], &#39;len&#39;: 5}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># But careful when using lazyprop that no one will change the value of a without deleting the property first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># if we change a...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># ... we still get the old cached value of len</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># if we delete the len prop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># ... then len being recomputed again</span>
<span class="go">generating &quot;len&quot;</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.util.lazyprop_w_sentinel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">lazyprop_w_sentinel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#lazyprop_w_sentinel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.lazyprop_w_sentinel" title="Link to this definition"></a></dt>
<dd><p>A descriptor implementation of lazyprop (cached property).
Inserts a <cite>self.func.__name__ + ‘__cache_active’</cite> attribute</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
<span class="gp">... </span>    <span class="nd">@lazyprop_w_sentinel</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;generating &quot;len&quot;&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Test</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazyprop_w_sentinel</span><span class="o">.</span><span class="n">cache_is_active</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;len&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span>  <span class="c1"># let&#39;s look under the hood</span>
<span class="go">{&#39;a&#39;: [0, 1, 2, 3, 4]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>
<span class="go">generating &quot;len&quot;</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lazyprop_w_sentinel</span><span class="o">.</span><span class="n">cache_is_active</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;len&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># notice there&#39;s no &#39;generating &quot;len&quot;&#39; print this time!</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span>  <span class="c1"># let&#39;s look under the hood</span>
<span class="go">{&#39;a&#39;: [0, 1, 2, 3, 4], &#39;len&#39;: 5, &#39;sentinel_of__len&#39;: True}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># But careful when using lazyprop that no one will change the value of a without deleting the property first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># if we change a...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># ... we still get the old cached value of len</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># if we delete the len prop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">len</span>  <span class="c1"># ... then len being recomputed again</span>
<span class="go">generating &quot;len&quot;</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.max_common_prefix">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">max_common_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#max_common_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.max_common_prefix" title="Link to this definition"></a></dt>
<dd><p>Given a list of strings (or other sliceable seq), returns the longest common prefix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>a</strong> – list-like of strings</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the smallest common prefix of all strings in a</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">max_common_prefix</span><span class="p">([</span><span class="s1">&#39;absolutely&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;abba&#39;</span><span class="p">])</span>
<span class="go">&#39;ab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_common_prefix</span><span class="p">([</span><span class="s1">&#39;absolutely&#39;</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;abba&#39;</span><span class="p">])</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_common_prefix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">[3, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_common_prefix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>If the input is empty, will return default (which defaults to ‘’).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">max_common_prefix</span><span class="p">([])</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>If you want a different default, you can specify it with the default
keyword argument.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_max_common_prefix</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">max_common_prefix</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_max_common_prefix</span><span class="p">([])</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.named_partial">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">named_partial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__name__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#named_partial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.named_partial" title="Link to this definition"></a></dt>
<dd><p>functools.partial, but with a __name__</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">named_partial</span><span class="p">(</span><span class="nb">print</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;print&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">named_partial</span><span class="p">(</span><span class="nb">print</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="o">=</span><span class="s1">&#39;now_partial_has_a_name&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span>
<span class="go">&#39;now_partial_has_a_name&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.norm_kv_filt">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">norm_kv_filt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kv_filt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#norm_kv_filt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.norm_kv_filt" title="Link to this definition"></a></dt>
<dd><p>Prepare a boolean function to be used with <cite>filter</cite> when fed an iterable of (k, v) pairs.</p>
<p>So you have a mapping. Say a dict <cite>d</cite>. Now you want to go through d.items(),
filtering based on the keys, or the values, or both.</p>
<p>It’s not hard to do, really. If you’re using a dict you might use a dict comprehension,
or in the general case you might do a <cite>filter(lambda kv: my_filt(kv[0], kv[1]), d.items())</cite>
if you have a <cite>my_filt</cite> that works wiith k and v, etc.</p>
<p>But thought simple, it can become a bit muddled.
<cite>norm_kv_filt</cite> simplifies this by allowing you to bring your own filtering boolean function,
whether it’s a key-based, value-based, or key-value-based one, and it will make a
ready-to-use with <cite>filter</cite> function for you.</p>
<p>Only thing: Your function needs to call a key <cite>k</cite> and a value <cite>v</cite>.
But hey, it’s alright, if you have a function that calls things differently, just do
something like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_filt_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">your_filt_func</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>and all will be fine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kv_filt</strong> – callable (starting with signature (k), (v), or (k, v)), and returning  a boolean</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A normalized callable.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">norm_kv_filt</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">}),</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<span class="go">[(&#39;b&#39;, 2), (&#39;d&#39;, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">norm_kv_filt</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<span class="go">[(&#39;c&#39;, 3), (&#39;d&#39;, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">norm_kv_filt</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;c&#39;</span><span class="p">)),</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<span class="go">[(&#39;b&#39;, 2), (&#39;d&#39;, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.not_a_mac_junk_path">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">not_a_mac_junk_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#not_a_mac_junk_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.not_a_mac_junk_path" title="Link to this definition"></a></dt>
<dd><p>A function that will tell you if the path is not a mac junk path/
More precisely, doesn’t end with ‘.DS_Store’ or have a <cite>__MACOSX</cite> folder somewhere
on it’s way.</p>
<p>This is usually meant to be used with <cite>filter</cite> or <cite>filt_iter</cite> to “filter in” only
those actually wanted files (not the junk that mac writes to your filesystem).</p>
<p>These files annoyingly show up often in zip files, and are usually unwanted.</p>
<p>See <a class="reference external" href="https://apple.stackexchange.com/questions/239578/compress-without-ds-store-and-macosx">https://apple.stackexchange.com/questions/239578/compress-without-ds-store-and-macosx</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A/normal/path&#39;</span><span class="p">,</span> <span class="s1">&#39;A/__MACOSX/path&#39;</span><span class="p">,</span> <span class="s1">&#39;path/ending/in/.DS_Store&#39;</span><span class="p">,</span> <span class="s1">&#39;foo/b&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">not_a_mac_junk_path</span><span class="p">,</span> <span class="n">paths</span><span class="p">))</span>
<span class="go">[&#39;A/normal/path&#39;, &#39;foo/b&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.num_of_args">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">num_of_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#num_of_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.num_of_args" title="Link to this definition"></a></dt>
<dd><p>Number of arguments (parameters) of the function.</p>
<p>Contrast the behavior below with that of <code class="docutils literal notranslate"><span class="pre">num_of_required_args</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.num_of_required_args">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">num_of_required_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#num_of_required_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.num_of_required_args" title="Link to this definition"></a></dt>
<dd><p>Number or REQUIRED arguments of a function.</p>
<p>Contrast the behavior below with that of <code class="docutils literal notranslate"><span class="pre">num_of_args</span></code>, which counts all
parameters, including the variadics and defaulted ones.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_required_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_required_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_of_required_args</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.partialclass">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">partialclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#partialclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.partialclass" title="Link to this definition"></a></dt>
<dd><p>What partial(cls, <a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs) does, but returning a class instead of an object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – Class to get the partial of</p></li>
<li><p><strong>kwargs</strong> – The kwargs to fix</p></li>
</ul>
</dd>
</dl>
<p>The raison d’être of partialclass is that it returns a type, so let’s have a look at that with
a useless class.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">signature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">partialclass</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mysum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(a=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">}</span><span class="s2">, b=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="o">==</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">partialclass</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">signature</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;(a=0, b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">mysum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;A(a=0, b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">A</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mysum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;A(a=0, b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span> <span class="o">=</span> <span class="n">partialclass</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">signature</span><span class="p">(</span><span class="n">AA</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;(a=0, *, b=2)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aa</span> <span class="o">=</span> <span class="n">AA</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">aa</span><span class="o">.</span><span class="n">mysum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">aa</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;A(a=0, b=2)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">AA</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mysum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;A(a=3, b=2)&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span> <span class="o">=</span> <span class="n">partialclass</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">signature</span><span class="p">(</span><span class="n">AA</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;(*, a=7, b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">AA</span><span class="p">()</span><span class="o">.</span><span class="n">mysum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;A(a=3, b=1)&#39;</span>
</pre></div>
</div>
<p>Note in the last partial that since <code class="docutils literal notranslate"><span class="pre">a</span></code> was fixed, you need to specify the keyword <code class="docutils literal notranslate"><span class="pre">AA(a=3)</span></code>.
<code class="docutils literal notranslate"><span class="pre">AA(3)</span></code> won’t work:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">__init__() got multiple values for argument &#39;a&#39;</span>
</pre></div>
</div>
<p>On the other hand, you can use <a href="#id5"><span class="problematic" id="id6">*</span></a>args to specify the fixtures:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span> <span class="o">=</span> <span class="n">partialclass</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">AA</span><span class="p">())</span> <span class="o">==</span> <span class="s1">&#39;A(a=22, b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">signature</span><span class="p">(</span><span class="n">AA</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;(b=1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;A(a=22, b=3)&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.regroupby">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">regroupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key_funcs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">named_key_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#regroupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.regroupby" title="Link to this definition"></a></dt>
<dd><p>Recursive groupby. Applies the groupby function recursively, using a sequence of key functions.</p>
<dl class="simple">
<dt>Note: The named_key_funcs argument names don’t have any external effect.</dt><dd><p>They just give a name to the key function, for code reading clarity purposes.</p>
</dd>
</dl>
<p>See Also: groupby, itertools.groupby, and dol.source.SequenceKvReader</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># group by how big the number is, then by it&#39;s mod 3 value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that named_key_funcs argument names doesn&#39;t have any external effect (but give a name to the function)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regroupby</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;big&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">mod3</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{&#39;small&#39;: {1: [1, 4], 2: [2, 5], 0: [3]}, &#39;big&#39;: {0: [6], 1: [7]}}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;fox&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">word_category</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;stopwords&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stopwords</span> <span class="k">else</span> <span class="s1">&#39;words&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regroupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">word_category</span><span class="p">,</span> <span class="nb">len</span><span class="p">)</span>
<span class="go">{&#39;stopwords&#39;: {3: [&#39;the&#39;], 2: [&#39;in&#39;], 1: [&#39;a&#39;]}, &#39;words&#39;: {3: [&#39;fox&#39;, &#39;box&#39;], 2: [&#39;is&#39;]}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regroupby</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="n">word_category</span><span class="p">)</span>
<span class="go">{3: {&#39;stopwords&#39;: [&#39;the&#39;], &#39;words&#39;: [&#39;fox&#39;, &#39;box&#39;]}, 2: {&#39;words&#39;: [&#39;is&#39;], &#39;stopwords&#39;: [&#39;in&#39;]}, 1: {&#39;stopwords&#39;: [&#39;a&#39;]}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.util.staticproperty">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">staticproperty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#staticproperty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.staticproperty" title="Link to this definition"></a></dt>
<dd><p>A decorator for defining static properties in classes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nd">@staticproperty</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">foo</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">()</span><span class="o">.</span><span class="n">foo</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.str_to_var_str">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">str_to_var_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/dol/util.html#str_to_var_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.str_to_var_str" title="Link to this definition"></a></dt>
<dd><p>Make a valid python variable string from the input string.
Left untouched if already valid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">str_to_var_str</span><span class="p">(</span><span class="s1">&#39;this_is_a_valid_var_name&#39;</span><span class="p">)</span>
<span class="go">&#39;this_is_a_valid_var_name&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">str_to_var_str</span><span class="p">(</span><span class="s1">&#39;not valid  #)*(&amp;434&#39;</span><span class="p">)</span>
<span class="go">&#39;not_valid_______434&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">str_to_var_str</span><span class="p">(</span><span class="s1">&#39;99_ballons&#39;</span><span class="p">)</span>
<span class="go">&#39;_99_ballons&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.truncate_string_with_marker">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">truncate_string_with_marker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">middle_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'...'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#truncate_string_with_marker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.truncate_string_with_marker" title="Link to this definition"></a></dt>
<dd><p>Return a string with a limited length.</p>
<p>If the string is longer than the sum of the left_limit and right_limit,
the string is truncated and the middle_marker is inserted in the middle.</p>
<p>If the string is shorter than the sum of the left_limit and right_limit,
the string is returned as is.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string_with_marker</span><span class="p">(</span><span class="s1">&#39;1234567890&#39;</span><span class="p">)</span>
<span class="go">&#39;1234567890&#39;</span>
</pre></div>
</div>
<p>But if the string is longer than the sum of the limits, it is truncated:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string_with_marker</span><span class="p">(</span><span class="s1">&#39;1234567890&#39;</span><span class="p">,</span> <span class="n">left_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">right_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;123...890&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string_with_marker</span><span class="p">(</span><span class="s1">&#39;1234567890&#39;</span><span class="p">,</span> <span class="n">left_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">right_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;123...&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string_with_marker</span><span class="p">(</span><span class="s1">&#39;1234567890&#39;</span><span class="p">,</span> <span class="n">left_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;...890&#39;</span>
</pre></div>
</div>
<p>If you’re using a specific parametrization of the function often, you can
create a partial function with the desired parameters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">truncate_string_with_marker</span><span class="p">,</span> <span class="n">left_limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">right_limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">middle_marker</span><span class="o">=</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string</span><span class="p">(</span><span class="s1">&#39;1234567890&#39;</span><span class="p">)</span>
<span class="go">&#39;12---90&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_string</span><span class="p">(</span><span class="s1">&#39;supercalifragilisticexpialidocious&#39;</span><span class="p">)</span>
<span class="go">&#39;su---us&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.written_bytes">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">written_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file_writer:</span> <span class="pre">~typing.Callable[[VT,</span> <span class="pre">~_io.BytesIO</span> <span class="pre">|</span> <span class="pre">~_io.StringIO],</span> <span class="pre">~typing.Any],</span> <span class="pre">obj:</span> <span class="pre">VT</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">*,</span> <span class="pre">obj_arg_position_in_writer:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">io_buffer_cls:</span> <span class="pre">~_io.BytesIO</span> <span class="pre">|</span> <span class="pre">~_io.StringIO</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'_io.BytesIO'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#written_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.written_bytes" title="Link to this definition"></a></dt>
<dd><p>Takes a file writing function that expects an object and a file-like object,
and returns a function that instead of writing to a file, returns the bytes that
would have been written.</p>
<p>Note: If obj is not given, write_bytes will return a “bytes writer” function that
takes obj as the first argument, and uses the file_writer to write the bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_writer</strong> – A function that writes an object to a file-like object.</p></li>
<li><p><strong>obj</strong> – The object to write.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bytes that would have been written to a file.</p>
</dd>
</dl>
<p>Use case: When you have a function that writes to files, and you want to get an
equivalent function but that gives you what bytes or string WOULD have been written
to a file, so you can better reuse (to write elsewhere, for example, or because
you need to pipe those bytes to another function).</p>
<p>Example usage: Yes, we have json.dumps to get the JSON string, but what if
(like is often the case) you just have a function that writes to a file-like object,
like the <cite>json.dump(obj, fp)</cite> function? You can use <cite>written_bytes</cite> to get a
function that will act as <cite>json.dumps</cite> like so:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_json_bytes</span> <span class="o">=</span> <span class="n">written_bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span> <span class="n">io_buffer_cls</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_json_bytes</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2}&#39;</span>
</pre></div>
</div>
<p>Here’s another example with pandas DataFrame.to_parquet:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import pandas as pd</span>
</pre></div>
</div>
<dl class="simple">
<dt>df = pd.DataFrame({</dt><dd><p>‘column1’: [1, 2, 3],
‘column2’: [‘A’, ‘B’, ‘C’]</p>
</dd>
</dl>
<p>})</p>
<p># Get a function that converts DataFrame to Parquet bytes
df_to_parquet_bytes = written_bytes(pd.DataFrame.to_parquet)</p>
<p># Get the bytes of the DataFrame in Parquet format
parquet_bytes = df_to_parquet_bytes(df)
all(pd.read_parquet(io.BytesIO(parquet_bytes)) == df)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.util.written_key">
<span class="sig-prename descclassname"><span class="pre">dol.util.</span></span><span class="sig-name descname"><span class="pre">written_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">VT</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">VT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">KT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">KT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">VT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KT</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_arg_position_in_writer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/util.html#written_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.util.written_key" title="Link to this definition"></a></dt>
<dd><p>Writes an object to a key and returns the key.
If key is not given, a temporary file is created and its path is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – The object to write.</p></li>
<li><p><strong>writer</strong> – A function that writes an object to a file.</p></li>
<li><p><strong>key</strong> – The key (by default, filepath) to write to.
If None, a temporary file is created.
If a string with a ‘*’, the ‘*’ is replaced with a unique temporary filename.</p></li>
<li><p><strong>obj_arg_position_in_writer</strong> – Position of the object argument in writer function (0 or 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The file path where the object was written.</p>
</dd>
</dl>
<p>Example usage:</p>
<p>Let’s make a store and a writer for that store.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">store</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
<p>Note the order a writer expects is (obj, key), or we’d just be able to use
<cite>store.__setitem__</cite> as our writer.</p>
<p>If we specify a key, the object will be written to that key in the store
and the key is output.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">written_key</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;my_key&#39;</span><span class="p">)</span>
<span class="go">&#39;my_key&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span>
<span class="go">{&#39;my_key&#39;: 42}</span>
</pre></div>
</div>
<p>Often, you’ll want to fix your writer (and possibly your key).
You can do so with <cite>functools.partial</cite>, but for convenience, you can also
just specify a writer, without an input object, and get a function that
will write an object to a key.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write_to_store</span> <span class="o">=</span> <span class="n">written_key</span><span class="p">(</span><span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;another_key&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_to_store</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">&#39;another_key&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span>
<span class="go">{&#39;my_key&#39;: 42, &#39;another_key&#39;: 99}</span>
</pre></div>
</div>
<p>If you don’t specify a key, a temporary file is created and the key is output.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write_to_store</span> <span class="o">=</span> <span class="n">written_key</span><span class="p">(</span><span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">write_to_store</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>  
<span class="go">&#39;/var/folders/mc/c070wfh51kxd9lft8dl74q1r0000gn/T/tmp8yaczd8b&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="go">43</span>
</pre></div>
</div>
<p>If the key you specify is a string with a ‘*’, the ‘*’ is replaced with a
unique temporary filename, or the full path of the temporary file if the *
is at the start.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write_to_store</span> <span class="o">=</span> <span class="n">written_key</span><span class="p">(</span><span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;*.ext&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">write_to_store</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span>  
<span class="go">&#39;....ext&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="go">44</span>
</pre></div>
</div>
<p>One useful use case is when you want to pipe the output of one function into
another function that expects a file path.
What you need to do then is just pipe your written_key function into that
function that expects to work with a file path, and it’ll be like piping the
value of your input object into that function (just via a temp file).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol.util</span> <span class="kn">import</span> <span class="n">Pipe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe_obj_to_reader</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">written_key</span><span class="p">(</span><span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">),</span> <span class="n">key_func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe_obj_to_reader</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="go">450</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span>  
<span class="go">{...: 45}</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="trans.html" class="btn btn-neutral float-left" title="dol.trans" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="zipfiledol.html" class="btn btn-neutral float-right" title="dol.zipfiledol" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright NO COPYRIGHT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>