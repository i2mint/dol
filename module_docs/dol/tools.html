<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dol.tools &mdash; dol 0.2.46 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=cec019df"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dol.trans" href="trans.html" />
    <link rel="prev" title="dol.tests.utils_for_tests" href="tests/utils_for_tests.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            dol
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dol.html">dol</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendable.html">dol.appendable</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">dol.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">dol.caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="dig.html">dol.dig</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">dol.errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="explicit.html">dol.explicit</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesys.html">dol.filesys</a></li>
<li class="toctree-l1"><a class="reference internal" href="kv_codecs.html">dol.kv_codecs</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">dol.misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixins.html">dol.mixins</a></li>
<li class="toctree-l1"><a class="reference internal" href="naming.html">dol.naming</a></li>
<li class="toctree-l1"><a class="reference internal" href="paths.html">dol.paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">dol.recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap.html">dol.scrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap/new_store_wrap.html">dol.scrap.new_store_wrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="scrap/store_factories.html">dol.scrap.store_factories</a></li>
<li class="toctree-l1"><a class="reference internal" href="signatures.html">dol.signatures</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources.html">dol.sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/base_test.html">dol.tests.base_test</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/pickability_test.html">dol.tests.pickability_test</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/scrap.html">dol.tests.scrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_appendable.html">dol.tests.test_appendable</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_dol_tools.html">dol.tests.test_dol_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_edge_cases.html">dol.tests.test_edge_cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_fanout_stores.html">dol.tests.test_fanout_stores</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_filesys.html">dol.tests.test_filesys</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_kv_codecs.html">dol.tests.test_kv_codecs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_paths.html">dol.tests.test_paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/utils_for_tests.html">dol.tests.utils_for_tests</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">dol.tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.Forest"><code class="docutils literal notranslate"><span class="pre">Forest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.ask_user_for_value_when_missing"><code class="docutils literal notranslate"><span class="pre">ask_user_for_value_when_missing()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.cache_this"><code class="docutils literal notranslate"><span class="pre">cache_this()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.confirm_overwrite"><code class="docutils literal notranslate"><span class="pre">confirm_overwrite()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.convert_to_numerical_if_possible"><code class="docutils literal notranslate"><span class="pre">convert_to_numerical_if_possible()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.filter_prefixes"><code class="docutils literal notranslate"><span class="pre">filter_prefixes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.filter_regex"><code class="docutils literal notranslate"><span class="pre">filter_regex()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.filter_suffixes"><code class="docutils literal notranslate"><span class="pre">filter_suffixes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#dol.tools.iSliceStore"><code class="docutils literal notranslate"><span class="pre">iSliceStore</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="trans.html">dol.trans</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">dol.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="zipfiledol.html">dol.zipfiledol</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dol</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">dol.tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/module_docs/dol/tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dol.tools">
<span id="dol-tools"></span><h1>dol.tools<a class="headerlink" href="#module-dol.tools" title="Link to this heading"></a></h1>
<p>Various tools to add functionality to stores</p>
<dl class="py class">
<dt class="sig sig-object py" id="dol.tools.Forest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">Forest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">src:</span> <span class="pre">~typing.Any,</span> <span class="pre">*,</span> <span class="pre">get_node_keys:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Iterable[~typing.Any]],</span> <span class="pre">get_src_item:</span> <span class="pre">~typing.Callable[[~typing.Any,</span> <span class="pre">~typing.Any],</span> <span class="pre">bool],</span> <span class="pre">is_leaf:</span> <span class="pre">~typing.Callable[[~typing.Any,</span> <span class="pre">~typing.Any],</span> <span class="pre">bool],</span> <span class="pre">forest_type:</span> <span class="pre">type</span> <span class="pre">|</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'list'&gt;,</span> <span class="pre">leaf_trans:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">return_input&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#Forest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.Forest" title="Link to this definition"></a></dt>
<dd><p>Provides a key-value forest interface to objects.</p>
<p>A <a class="reference external" href="treehttps://en.wikipedia.org/wiki/Tree_(data_structure)">treehttps://en.wikipedia.org/wiki/Tree_(data_structure)</a>
is a nested data structure. A tree has a root, which is the parent of children,
who themselves can be parents of further subtrees, or not; in which case they’re
called leafs.
For more information, see
<a class="reference external" href="wikipediaontreeshttps://en.wikipedia.org/wiki/Tree_(data_structure)">wikipediaontreeshttps://en.wikipedia.org/wiki/Tree_(data_structure)</a></p>
<p>Here we allow one to construct a tree view of any python object, using a
key-value interface to the parent-child relationship.</p>
<p>A forest is a collection of trees.</p>
<p>Arguably, a dictionnary might not be the most impactful example to show here, since
it is naturally a tree (therefore a forest), and naturally key-valued: But it has
the advantage of being easy to demo with.
Where Forest would really be useful is when you (1) want to give a consistent
key-value interface to the many various forms that trees and forest objects come
in, or even more so when (2) your object’s tree/forest structure is not obvious,
so you need to “extract” that view from it (plus give it a consistent key-value
interface, so that you can build an ecosystem of tools around it.</p>
<p>Anyway, here’s our dictionary example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;apple&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;fruit&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;types&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s1">&#39;granny&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">},</span>
<span class="gp">... </span>            <span class="s1">&#39;fuji&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s1">&#39;tasty&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s1">&#39;acrobat&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;person&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;nationality&#39;</span><span class="p">:</span> <span class="s1">&#39;french&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s1">&#39;brave&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s1">&#39;ball&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;toy&#39;</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>Must of the time, you’ll want to curry <code class="docutils literal notranslate"><span class="pre">Forest</span></code> to make an <code class="docutils literal notranslate"><span class="pre">object_to_forest</span></code>
constructor for a given class of objects. In the case of dictionaries as the one
above, this might look like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_forest</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">Forest</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">is_leaf</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">get_node_keys</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">[</span><span class="n">vv</span> <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">vv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="n">get_src_item</span><span class="o">=</span><span class="k">lambda</span> <span class="n">src</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="n">src</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">a_forest</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[&#39;apple&#39;, &#39;acrobat&#39;]</span>
</pre></div>
</div>
<p>Note that we specified in <code class="docutils literal notranslate"><span class="pre">get_node_keys``that</span> <span class="pre">we</span> <span class="pre">didn't</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">include</span> <span class="pre">items</span>
<span class="pre">whose</span> <span class="pre">keys</span> <span class="pre">start</span> <span class="pre">with</span> <span class="pre">``b</span></code> as valid children. Therefore we don’t have our
<code class="docutils literal notranslate"><span class="pre">'ball'</span></code> in the list above.</p>
<p>Note below which nodes are themselves <code class="docutils literal notranslate"><span class="pre">Forests</span></code>, and whic are leafs:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ff</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">Forest</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
<span class="go">[&#39;kind&#39;, &#39;types&#39;, &#39;tasty&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span>
<span class="go">&#39;fruit&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fff</span> <span class="o">=</span> <span class="n">ff</span><span class="p">[</span><span class="s1">&#39;types&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">fff</span><span class="p">,</span> <span class="n">Forest</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">fff</span><span class="p">)</span>
<span class="go">[&#39;granny&#39;, &#39;fuji&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.ask_user_for_value_when_missing">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">ask_user_for_value_when_missing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_preprocessor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_missing_msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'No</span> <span class="pre">such</span> <span class="pre">key</span> <span class="pre">was</span> <span class="pre">found.</span> <span class="pre">You</span> <span class="pre">can</span> <span class="pre">enter</span> <span class="pre">a</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">it</span> <span class="pre">here</span> <span class="pre">or</span> <span class="pre">simply</span> <span class="pre">hit</span> <span class="pre">enter</span> <span class="pre">to</span> <span class="pre">leave</span> <span class="pre">the</span> <span class="pre">slot</span> <span class="pre">empty'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__module__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__name__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__qualname__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__doc__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__annotations__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__defaults__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">__kwdefaults__</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#ask_user_for_value_when_missing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.ask_user_for_value_when_missing" title="Link to this definition"></a></dt>
<dd><p>Wrap a store so if a value is missing when the user asks for it, they will be
given a chance to enter the value they want to write.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>store</strong> – The store (instance or class) to wrap</p></li>
<li><p><strong>value_preprocessor</strong> – Function to transform the user value before trying to
write it (bearing in mind all user specified values are strings)</p></li>
<li><p><strong>on_missing_msg</strong> – String that will be displayed to prompt the user to enter a
value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.cache_this">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">cache_this</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#cache_this"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.cache_this" title="Link to this definition"></a></dt>
<dd><p>Transforms a method into a cached property with control over cache object and key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be decorated (usually left empty).</p></li>
<li><p><strong>cache</strong> – The cache storage, can be a <cite>MutableMapping</cite> or the name of an
instance attribute that is a <cite>MutableMapping</cite>.</p></li>
<li><p><strong>key</strong> – The key to store the cache value, can be a callable that will be
applied to the method name to make a key, or an explicit string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function.</p>
</dd>
</dl>
<p>Used with no arguments, <cite>cache_this</cite> will cache just as the builtin
<cite>cached_property</cite> does – in the instance’s <cite>__dict__</cite> attribute.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SameAsCachedProperty</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nd">@cache_this</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In SameAsCachedProperty.foo...&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">SameAsCachedProperty</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span>  <span class="c1"># the cache is empty</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>  <span class="c1"># when we access foo, it&#39;s computed and returned...</span>
<span class="go">In SameAsCachedProperty.foo...</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span>  <span class="c1"># ... but also cached</span>
<span class="go">{&#39;foo&#39;: 42}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>  <span class="c1"># so that the next time we access foo, it&#39;s returned from the cache.</span>
<span class="go">42</span>
</pre></div>
</div>
<p>Specify the cache as a dictionary that lives outside the instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">external_cache</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CacheWithExternalMapping</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nd">@cache_this</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="n">external_cache</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In CacheWithExternalMapping.foo...&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">CacheWithExternalMapping</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">external_cache</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">In CacheWithExternalMapping.foo...</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">external_cache</span>
<span class="go">{&#39;foo&#39;: 42}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">42</span>
</pre></div>
</div>
<p>Specify the cache as an attribute of the instance, and an explicit key:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">WithCacheInInstanceAttribute</span><span class="p">:</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">my_cache</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@cache_this</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="s1">&#39;my_cache&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;key_for_foo&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In WithCacheInInstanceAttribute.foo...&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">WithCacheInInstanceAttribute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">my_cache</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">In WithCacheInInstanceAttribute.foo...</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">my_cache</span>
<span class="go">{&#39;key_for_foo&#39;: 42}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">42</span>
</pre></div>
</div>
<p>Now let’s see a more involved example that exhibits how <cite>cache_this</cite> would be used
in real life. Note two things in the example below.</p>
<p>First, that we use <cite>functools.partial</cite> to fix the parameters of our <cite>cache_this</cite>.
This enables us to reuse the same <cite>cache_this</cite> in multiple places without all
the verbosity. We fix that the cache is the attribute <cite>cache</cite> of the instance,
and that the key is a function that will be computed from the name of the method
adding a <cite>‘.pkl’</cite> extension to it.</p>
<p>Secondly, we use the <cite>ValueCodecs</cite> from <cite>dol</cite> to provide a pickle codec for storying
values. The backend store used here is a dictionary, so we don’t really need a
codec to store values, but in real life you would use a persistent storage that
would require a codec, such as files or a database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol</span> <span class="kn">import</span> <span class="n">ValueCodecs</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_with_pickle</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">cache_this</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="s1">&#39;cache&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">PickleCached</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend_store_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># usually this would be a mapping interface to persistent storage:</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_backend_store</span> <span class="o">=</span> <span class="n">backend_store_factory</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">ValueCodecs</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backend_store</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@cache_with_pickle</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In PickleCached.foo...&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">PickleCached</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">In PickleCached.foo...</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
<span class="go">42</span>
</pre></div>
</div>
<p>As usuall, it’s because the cache now holds something that has to do with <cite>foo</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">[&#39;foo.pkl&#39;]</span>
</pre></div>
</div>
<p>The value of <cite>‘foo.pkl’</cite> is indeed <cite>42</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;foo.pkl&#39;</span><span class="p">]</span>
<span class="go">42</span>
</pre></div>
</div>
<p>But note that the actual way it’s stored in the <cite>_backend_store</cite> is as pickle bytes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">_backend_store</span><span class="p">[</span><span class="s1">&#39;foo.pkl&#39;</span><span class="p">]</span>
<span class="go">b&#39;\x80\x04K*.&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.confirm_overwrite">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">confirm_overwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_input_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'The</span> <span class="pre">key</span> <span class="pre">{k}</span> <span class="pre">already</span> <span class="pre">exists</span> <span class="pre">and</span> <span class="pre">has</span> <span class="pre">value</span> <span class="pre">{existing_v}.</span> <span class="pre">If</span> <span class="pre">you</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">overwrite</span> <span class="pre">it</span> <span class="pre">with</span> <span class="pre">{v},</span> <span class="pre">confirm</span> <span class="pre">by</span> <span class="pre">typing</span> <span class="pre">{v}</span> <span class="pre">here:</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#confirm_overwrite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.confirm_overwrite" title="Link to this definition"></a></dt>
<dd><p>A preset function you can use in wrap_kvs to ask the user to confirm if
they’re writing a value in a key that already has a different value under it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol.trans</span> <span class="kn">import</span> <span class="n">wrap_kvs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;banana&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">wrap_kvs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">preset</span><span class="o">=</span><span class="n">confirm_overwrite</span><span class="p">)</span>
</pre></div>
</div>
<p>Overwriting <code class="docutils literal notranslate"><span class="pre">a</span></code> with the same value it already has is fine (not really an
over-write):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span>
</pre></div>
</div>
<p>Creating new values is also fine:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;coconut&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">d</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;coconut&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>But if we tried to do <code class="docutils literal notranslate"><span class="pre">d['a']</span> <span class="pre">=</span> <span class="pre">'alligator'</span></code>, we’ll get a user input request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">key</span> <span class="n">a</span> <span class="n">already</span> <span class="n">exists</span> <span class="ow">and</span> <span class="n">has</span> <span class="n">value</span> <span class="n">apple</span><span class="o">.</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">overwrite</span> <span class="n">it</span> <span class="k">with</span> <span class="n">alligator</span><span class="p">,</span> <span class="n">confirm</span> <span class="n">by</span> <span class="n">typing</span> <span class="n">alligator</span> <span class="n">here</span><span class="p">:</span>
</pre></div>
</div>
<p>And we’ll have to type <cite>alligator</cite> and press RETURN to make the write go through.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.convert_to_numerical_if_possible">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">convert_to_numerical_if_possible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#convert_to_numerical_if_possible"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.convert_to_numerical_if_possible" title="Link to this definition"></a></dt>
<dd><p>To be used with <code class="docutils literal notranslate"><span class="pre">ask_user_for_value_when_missing</span></code> <code class="docutils literal notranslate"><span class="pre">value_preprocessor</span></code> arg</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_numerical_if_possible</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
<span class="go">123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_numerical_if_possible</span><span class="p">(</span><span class="s2">&quot;123.4&quot;</span><span class="p">)</span>
<span class="go">123.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_numerical_if_possible</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
<span class="go">&#39;one&#39;</span>
</pre></div>
</div>
<p>Border case: The strings “infinity” and “inf” actually convert to a valid float.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_numerical_if_possible</span><span class="p">(</span><span class="s2">&quot;infinity&quot;</span><span class="p">)</span>
<span class="go">inf</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.filter_prefixes">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">filter_prefixes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefixes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#filter_prefixes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.filter_prefixes" title="Link to this definition"></a></dt>
<dd><p>Make a filter that returns True if a string starts with one of the given prefixes</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">starts_with_test</span> <span class="o">=</span> <span class="n">filter_prefixes</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starts_with_test</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starts_with_test</span><span class="p">(</span><span class="s2">&quot;report.doc&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_test_or_report</span> <span class="o">=</span> <span class="n">filter_prefixes</span><span class="p">([</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_test_or_report</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_test_or_report</span><span class="p">(</span><span class="s2">&quot;report.doc&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_test_or_report</span><span class="p">(</span><span class="s2">&quot;image.jpg&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.filter_regex">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">filter_regex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regex</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_search_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#filter_regex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.filter_regex" title="Link to this definition"></a></dt>
<dd><p>Make a filter that returns True if a string matches the given regex</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_txt</span> <span class="o">=</span> <span class="n">filter_regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*\.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_txt</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_txt</span><span class="p">(</span><span class="s2">&quot;report.doc&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dol.tools.filter_suffixes">
<span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">filter_suffixes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suffixes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#filter_suffixes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.filter_suffixes" title="Link to this definition"></a></dt>
<dd><p>Make a filter that returns True if a string ends with one of the given suffixes</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ends_with_txt</span> <span class="o">=</span> <span class="n">filter_suffixes</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ends_with_txt</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ends_with_txt</span><span class="p">(</span><span class="s2">&quot;report.doc&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_text</span> <span class="o">=</span> <span class="n">filter_suffixes</span><span class="p">([</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;.doc&#39;</span><span class="p">,</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_text</span><span class="p">(</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_text</span><span class="p">(</span><span class="s2">&quot;report.doc&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_text</span><span class="p">(</span><span class="s2">&quot;image.jpg&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dol.tools.iSliceStore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dol.tools.</span></span><span class="sig-name descname"><span class="pre">iSliceStore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dol/tools.html#iSliceStore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dol.tools.iSliceStore" title="Link to this definition"></a></dt>
<dd><p>Wraps a store to make a reader that acts as if the store was a list
(with integer keys, and that can be sliced).
I say “list”, but it should be noted that the behavior is more that of range,
that outputs an element of the list
when keying with an integer, but returns an iterable object (a range) if sliced.</p>
<p>Here, a map object is returned when the sliceable store is sliced.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;world&#39;</span><span class="p">,</span> <span class="s1">&#39;alice&#39;</span><span class="p">:</span> <span class="s1">&#39;bob&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliceable_s</span> <span class="o">=</span> <span class="n">iSliceStore</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>The read-only functionalities of the underlying mapping are still available:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">)</span>
<span class="go">[&#39;foo&#39;, &#39;hello&#39;, &#39;alice&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;hello&#39;</span> <span class="ow">in</span> <span class="n">sliceable_s</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliceable_s</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span>
<span class="go">&#39;world&#39;</span>
</pre></div>
</div>
<p>But now you can get slices as well:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[&#39;bar&#39;, &#39;world&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="go">[&#39;world&#39;, &#39;bob&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[&#39;bar&#39;, &#39;world&#39;]</span>
</pre></div>
</div>
<p>Now, you can’t do <cite>sliceable_s[1]</cite> because <cite>1</cite> isn’t a valid key.
But if you really wanted “item number 1”, you can do:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="go">&#39;world&#39;</span>
</pre></div>
</div>
<p>Note that <cite>sliceable_s[i:j]</cite> is an iterable that needs to be consumed
(here, with list) to actually get the data. If you want your data in a different
format, you can use <cite>dol.trans.wrap_kvs</cite> for that.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dol</span> <span class="kn">import</span> <span class="n">wrap_kvs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span> <span class="o">=</span> <span class="n">wrap_kvs</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">,</span> <span class="n">obj_of_data</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[&#39;world&#39;, &#39;bob&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sss</span> <span class="o">=</span> <span class="n">wrap_kvs</span><span class="p">(</span><span class="n">sliceable_s</span><span class="p">,</span> <span class="n">obj_of_data</span><span class="o">=</span><span class="nb">sorted</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sss</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[&#39;bob&#39;, &#39;world&#39;]</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tests/utils_for_tests.html" class="btn btn-neutral float-left" title="dol.tests.utils_for_tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="trans.html" class="btn btn-neutral float-right" title="dol.trans" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright NO COPYRIGHT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>